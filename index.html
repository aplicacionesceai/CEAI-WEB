<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEAI - √Årea de Innovaci√≥n y Competitividad</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        #carouselNoticias {
            max-width: 700px;
            margin: 0 auto;
        }
        #carouselNoticias .carousel-inner {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.12);
        }
        #carouselNoticias .carousel-item {
            min-height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #carouselNoticias img {
            max-height: 240px;
            object-fit: cover;
            width: 100%;
        }
        #carouselNoticias .card {
            height: 100%;
            border: none;
        }
        #carouselNoticias .card-body {
            padding: 1.2rem;
        }
        #carouselNoticias .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        #carouselNoticias .card-text {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        #carouselNoticias .badge {
            font-size: 0.8rem;
            padding: 0.4rem 0.7rem;
        }
        .carousel-control-prev,
        .carousel-control-next {
            width: 40px;
            height: 40px;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(57, 169, 0, 0.7);
            border-radius: 50%;
            opacity: 0.8;
            transition: all 0.3s;
        }
        .carousel-control-prev:hover,
        .carousel-control-next:hover {
            opacity: 1;
            background-color: rgba(57, 169, 0, 0.9);
        }
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            width: 20px;
            height: 20px;
        }
        .carousel-section {
            margin-bottom: 2rem;
        }
        .noticias-grid-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid var(--ceai-verde);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-ceai-dark sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="index.html">
                <span style="color: var(--ceai-verde);">CEAI</span> SENA
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="index.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="innovacion.html">√Årea de Innovaci√≥n</a></li>
                    <li class="nav-item"><a class="nav-link" href="grupo-investigacion.html">Grupo de Investigaci√≥n</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="semillerosDropdown" role="button" data-bs-toggle="dropdown">Semilleros</a>
                        <ul class="dropdown-menu" aria-labelledby="semillerosDropdown">
                            <li><a class="dropdown-item" href="semilleros.html">üìö Ver todos los semilleros</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">Por categor√≠a:</h6></li>
                            <li><a class="dropdown-item" href="semillero-detalle.html?categoria=Soluciones%20Digitales">üíª Soluciones Digitales</a></li>
                            <li><a class="dropdown-item" href="semillero-detalle.html?categoria=Automatizaci%C3%B3n%20e%20Instrumentaci%C3%B3n">ü§ñ Automatizaci√≥n e Instrumentaci√≥n</a></li>
                            <li><a class="dropdown-item" href="semillero-detalle.html?categoria=F%C3%A1brica%20Digital%20Interactiva">üè≠ F√°brica Digital Interactiva</a></li>
                            <li><a class="dropdown-item" href="semillero-detalle.html?categoria=Gesti%C3%B3n%20Energ%C3%A9tica">‚ö° Gesti√≥n Energ√©tica</a></li>
                            <li><a class="dropdown-item" href="semillero-detalle.html?categoria=IA%20Aplicada%20al%20Entorno">üß† IA Aplicada al Entorno</a></li>
                        </ul>   
                    </li>
                    <li class="nav-item"><a class="nav-link" href="servicios.html">Servicios</a></li>
                    <li class="nav-item"><a class="nav-link" href="aliados.html">Aliados</a></li>
                    <li class="nav-item"><a class="nav-link" href="contacto.html">Contacto</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="hero-section text-white py-5" style="background: linear-gradient(135deg, var(--ceai-azul) 0%, var(--ceai-verde-oscuro) 100%);">
        <div class="container py-5">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-3">Bienvenido al CEAI</h1>
                    <p class="lead mb-4">√Årea de Innovaci√≥n y Competitividad - SENA Regional Valle</p>
                    <p class="fs-5">Transformando ideas en soluciones tecnol√≥gicas para el ecosistema formativo y productivo.</p>
                    <a href="contacto.html" class="btn btn-ceai btn-lg mt-3">Cont√°ctanos</a>
                </div>
                <div class="col-lg-4 text-center d-none d-lg-block">
                    <div style="font-size: 120px; color: var(--ceai-verde);">üöÄ</div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-5 carousel-section" id="seccionCarrusel" style="display: none;">
        <div class="container">
            <h2 class="mb-4 text-center" style="color: var(--ceai-azul); font-weight: 700;">üåü Noticias Destacadas</h2>
            <div id="carouselNoticias" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
                <div class="carousel-inner" id="carouselNoticiasInner"></div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselNoticias" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselNoticias" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                </button>
            </div>
        </div>
    </section>

    <section class="py-5 noticias-grid-section">
        <div class="container">
            <h2 class="mb-4 text-center" style="color: var(--ceai-azul); font-weight: 700;">üì∞ √öltimas Noticias y Eventos</h2>
            <div class="row" id="noticiasContainer">
                <!-- Se cargan din√°micamente -->
            </div>
        </div>
    </section>

    <section class="py-5" style="background-color: #f8f9fa;">
        <div class="container">
            <h2 class="mb-4 text-center" style="color: var(--ceai-azul); font-weight: 700;">üå± Nuestros Semilleros de Investigaci√≥n</h2>
            <div class="row" id="semillerosContainer">
                <!-- Se cargan din√°micamente -->
            </div>
            <div class="text-center mt-4">
                <a href="semilleros.html" class="btn btn-outline-primary btn-lg">Ver todos los semilleros</a>
            </div>
        </div>
    </section>

    <footer class="bg-ceai-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5 style="color: var(--ceai-verde);">CEAI SENA</h5>
                    <p class="small">√Årea de Innovaci√≥n y Competitividad - Regional Valle</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h6>Enlaces R√°pidos</h6>
                    <ul class="list-unstyled small">
                        <li><a href="index.html" class="text-white-50 text-decoration-none">Inicio</a></li>
                        <li><a href="contacto.html" class="text-white-50 text-decoration-none">Contacto</a></li>
                        <li><a href="#" class="text-white-50 text-decoration-none">Pol√≠tica de Privacidad</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h6>Enlaces Externos</h6>
                    <ul class="list-unstyled small">
                        <li><a href="https://www.sena.edu.co" target="_blank" class="text-white-50 text-decoration-none">SENA Colombia</a></li>
                        <li><a href="https://www.sena.edu.co/es-co/" target="_blank" class="text-white-50 text-decoration-none">Regional Valle</a></li>
                    </ul>
                </div>
            </div>
            <hr class="border-secondary">
            <p class="text-center small mb-0">&copy; 2026 CEAI SENA Regional Valle. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ‚úÖ CORRECCI√ìN: URL correcta de la API
        const API = 'https://ceai-web-production.up.railway.app';

        async function cargarNoticiasHome() {
            try {
                console.log('üîç Intentando cargar noticias desde:', API + '/api/noticias');
                const res = await fetch(API + '/api/noticias');
                
                if (!res.ok) {
                    throw new Error('Error en la respuesta: ' + res.status);
                }
                
                const allNoticias = await res.json();
                console.log('‚úÖ Noticias cargadas:', allNoticias.length);

                const destacadas = allNoticias.filter(function(n) {
                    return n.destacada === 1 || n.destacada === '1';
                });

                console.log('‚≠ê Noticias destacadas:', destacadas.length);

                if (destacadas.length > 0) {
                    document.getElementById('seccionCarrusel').style.display = 'block';
                    cargarCarrusel(destacadas);
                } else {
                    document.getElementById('seccionCarrusel').style.display = 'none';
                }

                cargarGrid(allNoticias);
            } catch (err) {
                console.error('‚ùå Error cargando noticias:', err);
                document.getElementById('noticiasContainer').innerHTML = 
                    '<div class="col-12 text-center"><p class="text-danger">Error al cargar las noticias. Por favor, intenta m√°s tarde.</p></div>';
            }
        }

        function cargarCarrusel(noticias) {
            var inner = document.getElementById('carouselNoticiasInner');
            var html = '';

            for (var i = 0; i < noticias.length; i++) {
                var n = noticias[i];
                var activa = i === 0 ? ' active' : '';
                var imagen = (n.imagen && n.imagen.trim() !== '') ? n.imagen : 'img/placeholder-noticia.jpg';
                var tipo = n.tipo ? n.tipo : 'Noticia';
                var desc = n.descripcion ? n.descripcion.substring(0, 120) : '';

                html += '<div class="carousel-item' + activa + '">'
                    + '  <div class="card border-0">'
                    + '    <img src="' + imagen + '" class="card-img-top" alt="' + (n.titulo || '') + '" onerror="this.src=\'img/placeholder-noticia.jpg\'">'
                    + '    <div class="card-body">'
                    + '      <div class="d-flex justify-content-between align-items-center mb-2">'
                    + '        <span class="badge bg-success">' + tipo + '</span>'
                    + '        <small class="text-muted">' + (n.fecha || '') + '</small>'
                    + '      </div>'
                    + '      <h5 class="card-title">' + (n.titulo || '') + '</h5>'
                    + '      <p class="card-text text-muted">' + desc + '...</p>'
                    + '    </div>'
                    + '  </div>'
                    + '</div>';
            }

            inner.innerHTML = html;

            // Inicializar el carrusel de Bootstrap
            var carouselElement = document.getElementById('carouselNoticias');
            var carousel = new bootstrap.Carousel(carouselElement, {
                interval: 4000,
                ride: 'carousel',
                wrap: true,
                pause: 'hover'
            });

            console.log('‚úÖ Carrusel inicializado con', noticias.length, 'items');
        }

        function cargarGrid(noticias) {
            var container = document.getElementById('noticiasContainer');
            
            if (!noticias || noticias.length === 0) {
                container.innerHTML = '<div class="col-12 text-center"><p class="text-muted">No hay noticias disponibles.</p></div>';
                return;
            }

            var html = '';

            for (var i = 0; i < noticias.length; i++) {
                var n = noticias[i];
                var imagen = (n.imagen && n.imagen.trim() !== '') ? n.imagen : 'img/placeholder-noticia.jpg';
                var tipo = n.tipo ? n.tipo : 'Noticia';
                var badge = '';

                if (tipo === 'Evento') badge = 'bg-info';
                else if (tipo === 'Convocatoria') badge = 'bg-warning text-dark';
                else if (tipo === 'Resultado') badge = 'bg-success';
                else badge = 'bg-secondary';

                html += '<div class="col-md-4 mb-4">'
                    + '  <div class="card h-100 border-0 shadow-sm" style="transition: transform 0.3s; cursor: pointer;" onmouseover="this.style.transform=\'translateY(-5px)\'" onmouseout="this.style.transform=\'translateY(0)\'">'
                    + '    <img src="' + imagen + '" class="card-img-top" alt="' + (n.titulo || '') + '" style="height: 200px; object-fit: cover;" onerror="this.src=\'img/placeholder-noticia.jpg\'">'
                    + '    <div class="card-body">'
                    + '      <div class="mb-2">'
                    + '        <span class="badge ' + badge + '">' + tipo + '</span>'
                    + '        <small class="text-muted ms-2">' + (n.fecha || '') + '</small>'
                    + '      </div>'
                    + '      <h5 class="card-title" style="font-size: 1rem; font-weight: 600;">' + (n.titulo || '') + '</h5>'
                    + '      <p class="card-text text-muted" style="font-size: 0.9rem; line-height: 1.4;">' + (n.descripcion || '').substring(0, 100) + '...</p>'
                    + '    </div>'
                    + '    <div class="card-footer bg-white border-top-0">'
                    + '      <a href="#" class="btn btn-sm btn-ceai w-100">Leer m√°s</a>'
                    + '    </div>'
                    + '  </div>'
                    + '</div>';
            }

            container.innerHTML = html;
            console.log('‚úÖ Grid cargado con', noticias.length, 'noticias');
        }

        async function cargarSemillerosInicio() {
            try {
                console.log('üîç Intentando cargar semilleros desde:', API + '/api/semilleros');
                const response = await fetch(API + '/api/semilleros');
                
                if (!response.ok) {
                    throw new Error('Error en la respuesta: ' + response.status);
                }
                
                const semilleros = await response.json();
                console.log('‚úÖ Semilleros cargados:', semilleros.length);
                
                const categorias = {};
                semilleros.forEach(s => {
                    const cat = s.categoria || 'Sin categor√≠a';
                    if (!categorias[cat]) {
                        categorias[cat] = [];
                    }
                    categorias[cat].push(s);
                });
                
                const destacados = [];
                for (let cat in categorias) {
                    if (destacados.length < 3 && categorias[cat].length > 0) {
                        destacados.push(categorias[cat][0]);
                    }
                }
                
                cargarSemillerosHTML(destacados);
            } catch (err) {
                console.error('‚ùå Error cargando semilleros:', err);
                document.getElementById('semillerosContainer').innerHTML = 
                    '<div class="col-12 text-center"><p class="text-danger">Error al cargar los semilleros. Por favor, intenta m√°s tarde.</p></div>';
            }
        }

        function cargarSemillerosHTML(semilleros) {
            var container = document.getElementById('semillerosContainer');
            
            if (!semilleros || semilleros.length === 0) {
                container.innerHTML = '<div class="col-12 text-center"><p class="text-muted">No hay semilleros disponibles.</p></div>';
                return;
            }

            var html = '';

            for (var i = 0; i < semilleros.length; i++) {
                var s = semilleros[i];
                var imagen = (s.imagen && s.imagen.trim() !== '') ? s.imagen : 'img/placeholder-semillero.jpg';
                
                html += '<div class="col-md-4 mb-4">'
                    + '  <div class="card h-100 border-0 shadow-sm" style="transition: transform 0.3s; cursor: pointer;" onmouseover="this.style.transform=\'translateY(-5px)\'" onmouseout="this.style.transform=\'translateY(0)\'">'
                    + '    <img src="' + imagen + '" class="card-img-top" alt="' + (s.nombre || '') + '" style="height: 200px; object-fit: cover;" onerror="this.src=\'img/placeholder-semillero.jpg\'">'
                    + '    <div class="card-body">'
                    + '      <span class="badge bg-info mb-2">' + (s.categoria || 'Sin categor√≠a') + '</span>'
                    + '      <h5 class="card-title" style="font-size: 1.1rem; font-weight: 600;">' + (s.nombre || '') + '</h5>'
                    + '      <p class="card-text text-muted small">' + (s.linea || '') + '</p>'
                    + '    </div>'
                    + '    <div class="card-footer bg-white border-top-0">'
                    + '      <a href="semillero-detalle.html?id=' + s.id + '" class="btn btn-sm btn-ceai w-100">Ver semillero</a>'
                    + '    </div>'
                    + '  </div>'
                    + '</div>';
            }

            container.innerHTML = html;
            console.log('‚úÖ Semilleros mostrados:', semilleros.length);
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina cargada, iniciando carga de datos...');
            cargarNoticiasHome();
            cargarSemillerosInicio();
        });
    </script>

    <script src="js/main.js"></script>
    <script src="js/navbar.js"></script>
</body>
</html>
